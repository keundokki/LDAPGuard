# Basic ArgoCD Application for LDAPGuard
# This is the minimal configuration - just deploy the base manifests
#
# Prerequisites:
# 1. Create secrets first:
#    kubectl create secret generic ldapguard-secrets \
#      --from-literal=POSTGRES_PASSWORD="$(openssl rand -base64 24)" \
#      --from-literal=SECRET_KEY="$(openssl rand -base64 32)" \
#      --from-literal=ENCRYPTION_KEY="$(openssl rand -base64 32)" \
#      --from-literal=DATABASE_URL="postgresql+asyncpg://ldapguard:PASSWORD@postgres:5432/ldapguard" \
#      -n ldapguard
#
# 2. Apply this file:
#    kubectl apply -f argocd-basic.yaml

apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  name: ldapguard
  namespace: argocd
spec:
  project: default
  
  source:
    repoURL: https://github.com/keundokki/LDAPGuard
    targetRevision: main
    path: k8s
  
  destination:
    server: https://kubernetes.default.svc
    namespace: ldapguard
  
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
    syncOptions:
      - CreateNamespace=true
