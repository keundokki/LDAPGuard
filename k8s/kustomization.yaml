apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

namespace: ldapguard

resources:
  - namespace.yaml
  
  # Storage - Basic (ReadWriteOnce - works with any storage class)
  - storage/pvc-postgres.yaml
  - storage/pvc-redis.yaml
  # Uncomment if you have ReadWriteMany storage (NFS, CephFS, etc.)
  # - storage/pvc-backup.yaml
  
  # Stateful Services
  - statefulsets/postgres-statefulset.yaml
  - statefulsets/redis-statefulset.yaml
  
  # Application Deployments
  - deployments/api-deployment.yaml
  - deployments/worker-deployment.yaml
  - deployments/web-deployment.yaml
  
  # Services
  - services/postgres-service.yaml
  - services/redis-service.yaml
  - services/api-service.yaml
  - services/web-service.yaml
  
  # Configuration
  - config/configmap-app.yaml
  - config/configmap-nginx.yaml
  
  # Networking
  - network/middleware.yaml
  - network/networkpolicy.yaml

# Secrets: Create manually on cluster before deployment
# kubectl create secret generic ldapguard-secrets \
#   --from-literal=POSTGRES_PASSWORD="$(openssl rand -base64 24)" \
#   --from-literal=SECRET_KEY="$(openssl rand -base64 32)" \
#   --from-literal=ENCRYPTION_KEY="$(openssl rand -base64 32)" \
#   --from-literal=DATABASE_URL="postgresql+asyncpg://ldapguard:PASSWORD@postgres:5432/ldapguard" \
#   -n ldapguard

# For customization examples (ingress, resource limits, etc.), see examples/ directory

commonLabels:
  app.kubernetes.io/managed-by: kustomize
